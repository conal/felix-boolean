\begin{code}[hide]
{-# OPTIONS --safe --without-K #-}
module Felix.Boolean where

open import Level using (_âŠ”_)

open import Felix.Object
open import Felix.Raw
\end{code}

%<*Boolean>
\begin{code}
record Boolean {o} (obj : Set o) : Set o where
  field
    ğ”¹ : obj
open Boolean â¦ƒ â€¦ â¦„ public
\end{code}
%</Boolean>

%<*Logic>
\begin{code}
record Logic {o} {obj : Set o} â¦ƒ _ : Products obj â¦„ â¦ƒ _ : Boolean obj â¦„
             {â„“} (_â‡¨â€²_ : obj â†’ obj â†’ Set â„“) : Set (o âŠ” â„“) where
  private infix 0 _â‡¨_; _â‡¨_ = _â‡¨â€²_
  field
    false true : âŠ¤ â‡¨ ğ”¹
    not : ğ”¹ â‡¨ ğ”¹
    nand nor xor : ğ”¹ Ã— ğ”¹ â‡¨ ğ”¹

  and or : â¦ƒ _ : Category _â‡¨_ â¦„ â†’ ğ”¹ Ã— ğ”¹ â‡¨ ğ”¹
  and  = not âˆ˜ nand
  or   = not âˆ˜ nor

  condâ‚ : â¦ƒ _ : Category _â‡¨_ â¦„ â¦ƒ _ : Cartesian _â‡¨_ â¦„ â†’ ğ”¹ Ã— (ğ”¹ Ã— ğ”¹) â‡¨ ğ”¹
  -- condâ‚ = or âˆ˜ (and âŠ— and) âˆ˜ transpose âˆ˜ first (not â–µ id)
  condâ‚ = nand âˆ˜ (nand âŠ— nand) âˆ˜ transpose âˆ˜ first (not â–µ id)
  
  -- (c , (e , t))
  -- ((not c , c) , (e , t))
  -- ((not c , e) , (c , t))
  -- (not c âˆ§ e) âˆ¨ (c âˆ§ t)

  -- (not c âˆ§ e) âˆ¨ (c âˆ§ t)
  -- nand (not (not c âˆ§ e) , not (c âˆ§ t))
  -- nand (nand (not c , e) , nand (c , t))

open Logic â¦ƒ â€¦ â¦„ public
\end{code}
%</Logic>
